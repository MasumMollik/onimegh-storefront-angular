<div *ngIf="(signedIn$ | async) && (customerAddresses$ | async)?.length" class="card">
    <div class="card-header">
        <button (click)="step = 'selectAddress'" class="btn btn-light">Select Address</button>
    </div>
    <div [ngClass]="step === 'selectAddress' ? 'block' : 'hidden'" class="">
        <div class="d-flex flex-wrap">
            <div (click)="setShippingAddress(address)"
                 *ngFor="let address of customerAddresses$ | async"
                 class="customer-address">
                <div *ngFor="let line of getLines(address)" class="address-line">
                    {{ line }}
                </div>
            </div>
            <div class="d-flex align-items-end ml-3 mb-3">
                <button (click)="createAddress()" class="btn btn-secondary">Add new address</button>
            </div>
        </div>
    </div>
</div>
<div *ngIf="!(signedIn$ | async)" class="">
    <h2 class="text-lg font-medium text-gray-900">
        Contact information
    </h2>
    <form (focusout)="onCustomerFormBlur()" [formGroup]="contactForm">
        <div class="mt-4">
            <label
                class="block text-sm font-medium text-gray-700"
                htmlFor="emailAddress"
            >
                Email address
            </label>
            <div class="mt-1">
                <input
                    autoComplete="email"
                    class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"
                    formControlName="emailAddress"
                    id="emailAddress"
                    name="emailAddress"
                    type="email"
                />
            </div>
        </div>
        <div class="mt-4 grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-4">
            <div>
                <label
                    class="block text-sm font-medium text-gray-700"
                    htmlFor="firstName"
                >
                    First name
                </label>
                <div class="mt-1">
                    <input
                        autoComplete="given-name"
                        class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"
                        formControlName="firstName"
                        id="firstName"
                        name="firstName"
                        type="text"
                    />
                </div>
            </div>

            <div>
                <label
                    class="block text-sm font-medium text-gray-700"
                    htmlFor="lastName"
                >
                    Last name
                </label>
                <div class="mt-1">
                    <input
                        autoComplete="family-name"
                        class="block w-full border-gray-300 rounded-md shadow-sm focus:ring-primary-500 focus:border-primary-500 sm:text-sm"
                        formControlName="lastName"
                        id="lastName"
                        name="lastName"
                        type="text"
                    />
                </div>
            </div>
        </div>
    </form>
</div>

<div class="mt-10 border-t border-gray-200 pt-10">
    <h2 class="text-lg font-medium text-gray-900">
        Shipping Address
    </h2>
    <div class="card-body">
        <vsf-address-form #addressForm
                          (focusout)="onAddressFormBlur(addressForm.addressForm)"
                          [address]="shippingAddress$ | async"
                          [availableCountries]="availableCountries$ | async"></vsf-address-form>
    </div>
</div>
<!--<div class="mt-10 border-t border-gray-200 pt-10">-->
<!--    <h2 class="text-lg font-medium text-gray-900">-->
<!--        Shipping Method-->
<!--    </h2>-->
<!--    <vsf-radio-card-fieldset-->
<!--        [idFn]="getId"-->
<!--        [selectedItemId]="shippingMethodId"-->
<!--        (selectItem)="setShippingMethod($event.id)"-->
<!--    >-->
<!--        <div class="mt-4 grid grid-cols-1 gap-y-6 sm:grid-cols-2 sm:gap-x-4">-->
<!--            <vsf-radio-card *ngFor="let method of eligibleShippingMethods$ | async" [item]="method">-->
<!--                <span class="block text-sm font-medium text-gray-900">-->
<!--                    {{ method.name }}-->
<!--                </span>-->
<!--                <span class="mt-6 text-sm font-medium text-gray-900">-->
<!--                    {{ method.priceWithTax | formatPrice }}-->
<!--                </span>-->
<!--            </vsf-radio-card>-->
<!--        </div>-->
<!--    </vsf-radio-card-fieldset>-->
<!--</div>-->
<button (click)="proceedToPayment()"
        [disabled]="addressForm.valid"
        class="btn-primary mt-6 w-full space-x-2">
    <fa-icon icon="credit-card"></fa-icon>
    <span>Proceed to payment</span>
</button>
